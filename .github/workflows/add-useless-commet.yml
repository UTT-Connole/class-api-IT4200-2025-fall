name: Add Useless Comment

on:
    pull_request:
        types: [opened, synchronize, reopened]

permissions:
    contents: write
    pull-requests: write
    actions: write
    
jobs:
    wait-for-checks:
        name: Wait for other workflows
        runs-on: ubuntu-latest
        steps:
            - name: Wait for status checks
              uses: lewagon/wait-on-check-action@v1.3.4
              with:
                  ref: ${{ github.event.pull_request.head.sha }}
                  check-name: 'pylint'
                  repo-token: ${{ secrets.GITHUB_TOKEN }}
                  wait-interval: 10
                  
    add-useless-comment:
        name: Add Useless Comment to Python Files
        runs-on: ubuntu-latest
        needs: wait-for-checks

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4
              with:
                  token: ${{ secrets.GITHUB_TOKEN }}
                  fetch-depth: 0

            - name: Set up Python
              uses: actions/setup-python@v5
              with:
                  python-version: "3.13"

            - name: Install dependencies
              run: |
                  python -m venv .venv
                  . .venv/bin/activate
                  pip install rich

            - name: Add useless comment to Python files
              run: |
                  . .venv/bin/activate
                  python .github/workflows/scripts/add_useless_comment.py