import unittest
from fastapi.testclient import TestClient
from app import app

client = TestClient(app)

def test_guess_number_correct(monkeypatch):
    # Force the random number to be 5
    monkeypatch.setattr("random.randint", lambda a, b: 5)
    response = client.get("/guess?user_guess=5")
    assert response.status_code == 200
    data = response.json()
    assert data["result"] == "Correct!"
    assert data["secret"] == 5

def test_guess_number_wrong(monkeypatch):
    # Force the random number to be 7
    monkeypatch.setattr("random.randint", lambda a, b: 7)
    response = client.get("/guess?user_guess=3")
    assert response.status_code == 200
    data = response.json()
    assert data["result"] == "Wrong!"
    assert data["secret"] == 7

def test_guess_number_out_of_range():
    response = client.get("/guess?user_guess=15")
    assert response.status_code == 200
    data = response.json()
    # Even though it's out of range, API still handles it
    assert "result" in data
    assert "secret" in data
